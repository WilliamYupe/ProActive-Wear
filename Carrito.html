<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carrito de Compras - ProActive Wear</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .carrito-container {
      width: 80%;
      margin: 40px auto;
      background: rgba(0,0,0,0.7);
      padding: 20px;
      border-radius: 12px;
      color: #fff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #0f0;
      padding: 10px;
      text-align: center;
    }
    th {
      background-color: #00f;
      color: #fff;
    }
    .btn {
      padding: 8px 12px;
      border: none;
      cursor: pointer;
      border-radius: 6px;
      font-weight: bold;
    }
    .btn-eliminar {
      background: red;
      color: #fff;
    }
    .btn-vaciar {
      background: #f00;
      color: #fff;
      margin-top: 10px;
    }
    .btn-volver {
      background: #0f0;
      color: #000;
      text-decoration: none;
      display: inline-block;
      margin-top: 15px;
      padding: 8px 12px;
      border-radius: 6px;
    }
    .formulario {
      margin-top: 30px;
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 12px;
    }
    .formulario label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      color: #0f0;
    }
    .formulario input, 
    .formulario select, 
    .formulario textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      border: none;
    }
    .btn-comprar {
      margin-top: 15px;
      background: #0f0;
      color: #000;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <!-- Encabezado -->
  <header>
    <h1>ProActive Wear</h1>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="productos.html">Productos</a>
      <a href="nosotros.html">Nosotros</a>
      <a href="carrito.html">Carrito</a>
    </nav>
  </header>

  <!-- Carrito -->
  <div class="carrito-container">
    <h2>üõí Tu Carrito de Compras</h2>
    <table id="tabla-carrito">
      <thead>
        <tr>
          <th>Producto</th>
          <th>Precio</th>
          <th>Acci√≥n</th>
        </tr>
      </thead>
      <tbody>
        <!-- Aqu√≠ se insertan productos -->
      </tbody>
    </table>
    <h3 id="total">Total: Q0.00</h3>
    <button class="btn btn-vaciar" onclick="vaciarCarrito()">Vaciar Carrito</button>
    <br>
    <a href="productos.html" class="btn-volver">‚¨Ö Seguir Comprando</a>

    <!-- Formulario de compra -->
    <div class="formulario">
      <h2>üìù Finalizar Compra</h2>
      <form id="form-compra" onsubmit="procesarCompra(event)">
        <label for="nombre">Nombre completo:</label>
        <input type="text" id="nombre" required>

        <label for="direccion">Direcci√≥n de entrega:</label>
        <textarea id="direccion" rows="3" required></textarea>

        <label for="telefono">Tel√©fono de contacto:</label>
        <input type="tel" id="telefono" required>

        <label for="pago">M√©todo de pago:</label>
        <select id="pago" required>
          <option value="">--Selecciona--</option>
          <option value="tarjeta">Tarjeta de cr√©dito/d√©bito</option>
          <option value="efectivo">Efectivo contra entrega</option>
          <option value="transferencia">Transferencia bancaria</option>
        </select>

        <button type="submit" class="btn btn-comprar">‚úÖ Confirmar Pedido</button>
      </form>
    </div>
  </div>

  <!-- Script carrito -->
  <script>
    function mostrarCarrito() {
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      let tbody = document.querySelector("#tabla-carrito tbody");
      let total = 0;

      tbody.innerHTML = "";

      carrito.forEach((item, index) => {
        let fila = document.createElement("tr");

        let tdNombre = document.createElement("td");
        tdNombre.textContent = item.nombre;

        let tdPrecio = document.createElement("td");
        tdPrecio.textContent = "Q" + item.precio;

        let tdAccion = document.createElement("td");
        let btnEliminar = document.createElement("button");
        btnEliminar.textContent = "Eliminar";
        btnEliminar.className = "btn btn-eliminar";
        btnEliminar.onclick = () => eliminarProducto(index);
        tdAccion.appendChild(btnEliminar);

        fila.appendChild(tdNombre);
        fila.appendChild(tdPrecio);
        fila.appendChild(tdAccion);

        tbody.appendChild(fila);

        total += item.precio;
      });

      document.getElementById("total").textContent = "Total: Q" + total.toFixed(2);
    }

    function eliminarProducto(index) {
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      carrito.splice(index, 1);
      localStorage.setItem("carrito", JSON.stringify(carrito));
      mostrarCarrito();
    }

    function vaciarCarrito() {
      localStorage.removeItem("carrito");
      mostrarCarrito();
    }

    function procesarCompra(event) {
      event.preventDefault();
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      if (carrito.length === 0) {
        alert("‚ö† Tu carrito est√° vac√≠o, agrega productos antes de comprar.");
        return;
      }

      let nombre = document.getElementById("nombre").value;
      let direccion = document.getElementById("direccion").value;
      let telefono = document.getElementById("telefono").value;
      let pago = document.getElementById("pago").value;

      let total = carrito.reduce((t, p) => t + p.precio, 0).toFixed(2);

      // Crear contenido del pedido
      let pedido = "=== Pedido ProActive Wear ===\n\n";
      pedido += "üë§ Cliente: " + nombre + "\n";
      pedido += "üè† Direcci√≥n: " + direccion + "\n";
      pedido += "üìû Tel√©fono: " + telefono + "\n";
      pedido += "üí≥ Pago: " + pago + "\n\n";
      pedido += "üõç Productos:\n";

      carrito.forEach((item, i) => {
        pedido += (i+1) + ". " + item.nombre + " - Q" + item.precio + "\n";
      });

      pedido += "\nüí∞ Total: Q" + total + "\n";
      pedido += "=============================\n";

      // Generar archivo TXT
      let blob = new Blob([pedido], { type: "text/plain" });
      let link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "pedido.txt";
      link.click();

      alert("‚úÖ Pedido confirmado. Se descarg√≥ tu comprobante en TXT.");

      // Vaciar carrito y resetear formulario
      localStorage.removeItem("carrito");
      mostrarCarrito();
      document.getElementById("form-compra").reset();
    }

    // Cargar carrito al abrir la p√°gina
    window.onload = mostrarCarrito;
  </script>
</body>
</html>

